import React, {useState, useEffect}from "react";
import TabelGenerator from "./Tabel"

const RendementTabel = () => {
    let currentDate = new Date().toISOString().split('T')[0]
        //  in tabledata en de code t/m regel 14 pakt de API en vewerkt het in een object
        // tabledata = [{"fundId":1,"fundName":"ASN Duurzaam Aandelenfonds","prices":{"2025-02-17":175.33,"2025-02-14":177.34,"2025-02-13":175.43,"2025-02-12":176.8,"2025-02-11":177.59,"2025-02-10":176.05,"2025-02-07":177.01,"2025-02-06":175.6,"2025-02-05":174.08,"2025-02-04":174.79,"2025-02-03":176.14,"2025-01-31":176.7,"2025-01-30":174.76,"2025-01-29":174.64,"2025-01-28":173.03,"2025-01-27":175.03,"2025-01-24":176.21,"2025-01-23":176.84,"2025-01-22":175.71,"2025-01-21":174.55,"2025-01-20":174.76,"2025-01-17":174.03,"2025-01-16":172.76,"2025-01-15":170.66,"2025-01-14":171.84,"2025-01-13":172.66,"2025-01-10":173.81,"2025-01-09":173.75,"2025-01-08":173.19,"2025-01-07":172.96,"2025-01-06":172.46,"2025-01-03":172.43,"2025-01-02":171.14,"2024-12-31":170.71,"2024-12-30":171.63,"2024-12-27":171.89,"2024-12-24":171.28,"2024-12-23":170.65,"2024-12-20":171.06,"2024-12-19":172.81,"2024-12-18":174.23,"2024-12-17":174.85,"2024-12-16":174.51,"2024-12-13":175.87,"2024-12-12":175.85,"2024-12-11":175.15,"2024-12-10":175.49,"2024-12-09":176.1,"2024-12-06":175.7,"2024-12-05":176.74,"2024-12-04":175.96,"2024-12-03":175.46,"2024-12-02":173.69,"2024-11-29":172.82,"2024-11-28":172.22,"2024-11-27":173.78,"2024-11-26":174.71,"2024-11-25":175.13,"2024-11-22":171.54,"2024-11-21":170.05,"2024-11-20":169.32,"2024-11-19":169.04,"2024-11-18":169.85,"2024-11-15":172.26,"2024-11-14":171.89,"2024-11-13":172.55,"2024-11-12":174.81,"2024-11-11":172.54,"2024-11-08":172.4,"2024-11-07":171.74,"2024-11-06":170.35,"2024-11-05":169.76,"2024-11-04":170.14,"2024-11-01":168.87,"2024-10-31":170.88,"2024-10-30":172.82,"2024-10-29":173.44,"2024-10-28":172.51,"2024-10-25":172.81,"2024-10-24":172.16,"2024-10-23":173.61,"2024-10-22":174.7,"2024-10-21":175.28,"2024-10-18":175.24,"2024-10-17":174.53,"2024-10-16":176.05,"2024-10-15":177.07,"2024-10-14":175.44,"2024-10-11":174.87,"2024-10-10":174.97,"2024-10-09":173.42,"2024-10-08":172.98,"2024-10-07":172.98,"2024-10-04":172.83,"2024-10-03":173.35,"2024-10-02":173.84,"2024-10-01":174.08,"2024-09-30":175.62,"2024-09-27":174.98,"2024-09-26":173.17,"2024-09-25":173.14,"2024-09-24":172.8,"2024-09-23":172.05,"2024-09-20":173.43,"2024-09-19":171.36,"2024-09-18":172.57,"2024-09-17":173.16,"2024-09-16":172.88,"2024-09-13":171.94,"2024-09-12":170.8,"2024-09-11":169.83,"2024-09-10":169.85,"2024-09-09":168.55,"2024-09-06":170.04,"2024-09-05":171.05,"2024-09-04":173.5}}]
        const tijdelijke_Variabele = [{"fundId":1,"fundName":"ASN Duurzaam Aandelenfonds","prices":{"2025-02-17":175.33,"2025-02-14":177.34,"2025-02-13":175.43,"2025-02-12":176.8}}]
        
        const [tabledata, setTabledata] = useState(tijdelijke_Variabele)
        useEffect(() => {
            console.log('joost')
            const fetchData = async () => {
                // in apiResponse kan je de string aanpssen om meer data te verwerken. je moet bij funds=1 kan je cijfers invoegen. als je funds=1,2,3,4 dan zie je de volledige API
                const apiResponse = await fetch(`https://asn-tracker.paulvandenburg.nl/api/fund-prices?funds=1,2,3,4&date_from=2024-09-01&date_to=${currentDate}`)
                const JsonData = await apiResponse.json()
                setTabledata(JsonData)
            }
            fetchData()
    
        }, [])

        //const testbestand = tabledata.map(item => {console.log(`dit is een Item van for each:${item["fundId"]}`)})

    return (
        <div>
            <p>{`${tabledata[1]}`}</p>
            <TabelGenerator DataForTable = {tabledata[1]}/>
        </div>
    )
}

export default RendementTabel